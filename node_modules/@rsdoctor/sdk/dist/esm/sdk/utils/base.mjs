import path from "path";
import fs from "fs";
function findRoot(startDir = process.cwd()) {
    let dir = startDir;
    let firstPkgDir = null;
    while(dir !== path.parse(dir).root){
        if (fs.existsSync(path.join(dir, 'pnpm-workspace.yaml'))) return dir;
        if (fs.existsSync(path.join(dir, 'yarn.lock'))) return dir;
        if (fs.existsSync(path.join(dir, 'lerna.json'))) return dir;
        const pkgPath = path.join(dir, 'package.json');
        if (fs.existsSync(pkgPath)) {
            if (!firstPkgDir) firstPkgDir = dir;
            const pkg = JSON.parse(fs.readFileSync(pkgPath, 'utf8'));
            if (pkg.workspaces) return dir;
        }
        dir = path.dirname(dir);
    }
    if (firstPkgDir) return firstPkgDir;
    return null;
}
export { findRoot };
