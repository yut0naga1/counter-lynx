import { dirname, join } from "path";
import { Package } from "@rsdoctor/utils/common";
function isPackagePath(path) {
    return /(^|[/\\])node_modules[/\\]/.test(path);
}
const readPackageJson = (file, readFile)=>{
    let result;
    let current = file;
    while('/' !== current && !result){
        if (dirname(current) === current) break;
        current = dirname(current);
        if (readFile) result = readFile(join(current, 'package.json'));
        if (readFile) {
            if (!(null == result ? void 0 : result.name)) result = void 0;
        } else result = Package.getPackageMetaFromModulePath(file);
    }
    if (!result) return;
    if (readFile && (!result.name || !result.version)) return readPackageJson(dirname(current), readFile);
    return {
        ...result,
        root: current
    };
};
export { isPackagePath, readPackageJson };
