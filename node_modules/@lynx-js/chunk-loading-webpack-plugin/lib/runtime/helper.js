import { RuntimeGlobals as LynxRuntimeGlobals } from '@lynx-js/webpack-runtime-globals';
import rspack from '@rspack/core';
const RuntimeGlobals = Object.assign({}, rspack.RuntimeGlobals, LynxRuntimeGlobals);
const { Template } = rspack;
export const MODULE_TYPE = 'css/mini-extract';
export function generateFromTemplate(runtime) {
    return Template.getFunctionContent(runtime).replace(/\$RuntimeGlobals_(\w+)\$/g, (_, name) => RuntimeGlobals[name]);
}
export function compareIds(a, b) {
    if (a < b) {
        return -1;
    }
    if (a > b) {
        return 1;
    }
    return 0;
}
export function compareModulesByIdentifier(a, b) {
    return compareIds(a.identifier(), b.identifier());
}
export const getCssChunkObject = (mainChunk, compilation) => {
    const obj = {};
    const { chunkGraph } = compilation;
    for (const chunk of mainChunk.getAllAsyncChunks()) {
        // MiniCssExtractPlugin uses `chunkGraph.getOrderedChunkModulesIterable`
        // but it does not exist on Rspack.
        const modules = chunkGraph.getChunkModules(chunk);
        modules.sort(compareModulesByIdentifier);
        for (const module of modules) {
            if (module.type === MODULE_TYPE) {
                obj[chunk.id] = 1;
                break;
            }
        }
    }
    return obj;
};
//# sourceMappingURL=helper.js.map