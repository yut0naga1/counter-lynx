import { debug } from "../../../debug";
/**
 * Emitter which will dispatch to everyone but the
 * calling source.
 */
export function BackgroundEmitter() {
    const targets = {};
    return {
        on(source, handler) {
            targets[source] = handler;
        },
        off(source) {
            targets[source] = undefined;
        },
        emit(source, event) {
            Object.entries(targets).forEach(([name, f]) => {
                if (name !== source && f) {
                    debug(source, "->", name, event);
                    f(event);
                }
            });
        },
        connected() {
            return Object.keys(targets);
        },
    };
}
