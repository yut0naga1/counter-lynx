{"version":3,"file":"hooks.umd.js","sources":["../src/index.js"],"sourcesContent":["import { options as _options } from 'preact';\n\n/** @type {number} */\nlet currentIndex;\n\n/** @type {import('./internal').Component} */\nlet currentComponent;\n\n/** @type {import('./internal').Component} */\nlet previousComponent;\n\n/** @type {number} */\nlet currentHook = 0;\n\n/** @type {Array<import('./internal').Component>} */\nlet afterPaintEffects = [];\n\n// Cast to use internal Options type\nconst options = /** @type {import('./internal').Options} */ (_options);\n\nlet oldBeforeDiff = options._diff;\nlet oldBeforeRender = options._render;\nlet oldAfterDiff = options.diffed;\nlet oldCommit = options._commit;\nlet oldBeforeUnmount = options.unmount;\nlet oldRoot = options._root;\n\nconst RAF_TIMEOUT = 100;\nlet prevRaf;\n\n/** @type {(vnode: import('./internal').VNode) => void} */\noptions._diff = vnode => {\n\tcurrentComponent = null;\n\tif (oldBeforeDiff) oldBeforeDiff(vnode);\n};\n\noptions._root = (vnode, parentDom) => {\n\tif (vnode && parentDom._children && parentDom._children._mask) {\n\t\tvnode._mask = parentDom._children._mask;\n\t}\n\n\tif (oldRoot) oldRoot(vnode, parentDom);\n};\n\n/** @type {(vnode: import('./internal').VNode) => void} */\noptions._render = vnode => {\n\tif (oldBeforeRender) oldBeforeRender(vnode);\n\n\tcurrentComponent = vnode._component;\n\tcurrentIndex = 0;\n\n\tconst hooks = currentComponent.__hooks;\n\tif (hooks) {\n\t\tif (previousComponent === currentComponent) {\n\t\t\thooks._pendingEffects = [];\n\t\t\tcurrentComponent._renderCallbacks = [];\n\t\t\thooks._list.forEach(hookItem => {\n\t\t\t\tif (hookItem._nextValue) {\n\t\t\t\t\thookItem._value = hookItem._nextValue;\n\t\t\t\t}\n\t\t\t\thookItem._pendingArgs = hookItem._nextValue = undefined;\n\t\t\t});\n\t\t} else {\n\t\t\thooks._pendingEffects.forEach(invokeCleanup);\n\t\t\thooks._pendingEffects.forEach(invokeEffect);\n\t\t\thooks._pendingEffects = [];\n\t\t\tcurrentIndex = 0;\n\t\t}\n\t}\n\tpreviousComponent = currentComponent;\n};\n\n/** @type {(vnode: import('./internal').VNode) => void} */\noptions.diffed = vnode => {\n\tif (oldAfterDiff) oldAfterDiff(vnode);\n\n\tconst c = vnode._component;\n\tif (c && c.__hooks) {\n\t\tif (c.__hooks._pendingEffects.length) afterPaint(afterPaintEffects.push(c));\n\t\tc.__hooks._list.forEach(hookItem => {\n\t\t\tif (hookItem._pendingArgs) {\n\t\t\t\thookItem._args = hookItem._pendingArgs;\n\t\t\t}\n\t\t\thookItem._pendingArgs = undefined;\n\t\t});\n\t}\n\tpreviousComponent = currentComponent = null;\n};\n\n// TODO: Improve typing of commitQueue parameter\n/** @type {(vnode: import('./internal').VNode, commitQueue: any) => void} */\noptions._commit = (vnode, commitQueue) => {\n\tcommitQueue.some(component => {\n\t\ttry {\n\t\t\tcomponent._renderCallbacks.forEach(invokeCleanup);\n\t\t\tcomponent._renderCallbacks = component._renderCallbacks.filter(cb =>\n\t\t\t\tcb._value ? invokeEffect(cb) : true\n\t\t\t);\n\t\t} catch (e) {\n\t\t\tcommitQueue.some(c => {\n\t\t\t\tif (c._renderCallbacks) c._renderCallbacks = [];\n\t\t\t});\n\t\t\tcommitQueue = [];\n\t\t\toptions._catchError(e, component._vnode);\n\t\t}\n\t});\n\n\tif (oldCommit) oldCommit(vnode, commitQueue);\n};\n\n/** @type {(vnode: import('./internal').VNode) => void} */\noptions.unmount = vnode => {\n\tif (oldBeforeUnmount) oldBeforeUnmount(vnode);\n\n\tconst c = vnode._component;\n\tif (c && c.__hooks) {\n\t\tlet hasErrored;\n\t\tc.__hooks._list.forEach(s => {\n\t\t\ttry {\n\t\t\t\tinvokeCleanup(s);\n\t\t\t} catch (e) {\n\t\t\t\thasErrored = e;\n\t\t\t}\n\t\t});\n\t\tc.__hooks = undefined;\n\t\tif (hasErrored) options._catchError(hasErrored, c._vnode);\n\t}\n};\n\n/**\n * Get a hook's state from the currentComponent\n * @param {number} index The index of the hook to get\n * @param {number} type The index of the hook to get\n * @returns {any}\n */\nfunction getHookState(index, type) {\n\tif (options._hook) {\n\t\toptions._hook(currentComponent, index, currentHook || type);\n\t}\n\tcurrentHook = 0;\n\n\t// Largely inspired by:\n\t// * https://github.com/michael-klein/funcy.js/blob/f6be73468e6ec46b0ff5aa3cc4c9baf72a29025a/src/hooks/core_hooks.mjs\n\t// * https://github.com/michael-klein/funcy.js/blob/650beaa58c43c33a74820a3c98b3c7079cf2e333/src/renderer.mjs\n\t// Other implementations to look at:\n\t// * https://codesandbox.io/s/mnox05qp8\n\tconst hooks =\n\t\tcurrentComponent.__hooks ||\n\t\t(currentComponent.__hooks = {\n\t\t\t_list: [],\n\t\t\t_pendingEffects: []\n\t\t});\n\n\tif (index >= hooks._list.length) {\n\t\thooks._list.push({});\n\t}\n\n\treturn hooks._list[index];\n}\n\n/**\n * @template {unknown} S\n * @param {import('./index').Dispatch<import('./index').StateUpdater<S>>} [initialState]\n * @returns {[S, (state: S) => void]}\n */\nexport function useState(initialState) {\n\tcurrentHook = 1;\n\treturn useReducer(invokeOrReturn, initialState);\n}\n\n/**\n * @template {unknown} S\n * @template {unknown} A\n * @param {import('./index').Reducer<S, A>} reducer\n * @param {import('./index').Dispatch<import('./index').StateUpdater<S>>} initialState\n * @param {(initialState: any) => void} [init]\n * @returns {[ S, (state: S) => void ]}\n */\nexport function useReducer(reducer, initialState, init) {\n\t/** @type {import('./internal').ReducerHookState} */\n\tconst hookState = getHookState(currentIndex++, 2);\n\thookState._reducer = reducer;\n\tif (!hookState._component) {\n\t\thookState._value = [\n\t\t\t!init ? invokeOrReturn(undefined, initialState) : init(initialState),\n\n\t\t\taction => {\n\t\t\t\tconst currentValue = hookState._nextValue\n\t\t\t\t\t? hookState._nextValue[0]\n\t\t\t\t\t: hookState._value[0];\n\t\t\t\tconst nextValue = hookState._reducer(currentValue, action);\n\n\t\t\t\tif (currentValue !== nextValue) {\n\t\t\t\t\thookState._nextValue = [nextValue, hookState._value[1]];\n\t\t\t\t\thookState._component.setState({});\n\t\t\t\t}\n\t\t\t}\n\t\t];\n\n\t\thookState._component = currentComponent;\n\n\t\tif (!currentComponent._hasScuFromHooks) {\n\t\t\tcurrentComponent._hasScuFromHooks = true;\n\t\t\tlet prevScu = currentComponent.shouldComponentUpdate;\n\t\t\tconst prevCWU = currentComponent.componentWillUpdate;\n\n\t\t\t// If we're dealing with a forced update `shouldComponentUpdate` will\n\t\t\t// not be called. But we use that to update the hook values, so we\n\t\t\t// need to call it.\n\t\t\tcurrentComponent.componentWillUpdate = function (p, s, c) {\n\t\t\t\tif (this._force) {\n\t\t\t\t\tlet tmp = prevScu;\n\t\t\t\t\t// Clear to avoid other sCU hooks from being called\n\t\t\t\t\tprevScu = undefined;\n\t\t\t\t\tupdateHookState(p, s, c);\n\t\t\t\t\tprevScu = tmp;\n\t\t\t\t}\n\n\t\t\t\tif (prevCWU) prevCWU.call(this, p, s, c);\n\t\t\t};\n\n\t\t\t// This SCU has the purpose of bailing out after repeated updates\n\t\t\t// to stateful hooks.\n\t\t\t// we store the next value in _nextValue[0] and keep doing that for all\n\t\t\t// state setters, if we have next states and\n\t\t\t// all next states within a component end up being equal to their original state\n\t\t\t// we are safe to bail out for this specific component.\n\t\t\t/**\n\t\t\t *\n\t\t\t * @type {import('./internal').Component[\"shouldComponentUpdate\"]}\n\t\t\t */\n\t\t\t// @ts-ignore - We don't use TS to downtranspile\n\t\t\t// eslint-disable-next-line no-inner-declarations\n\t\t\tfunction updateHookState(p, s, c) {\n\t\t\t\tif (!hookState._component.__hooks) return true;\n\n\t\t\t\t/** @type {(x: import('./internal').HookState) => x is import('./internal').ReducerHookState} */\n\t\t\t\tconst isStateHook = x => !!x._component;\n\t\t\t\tconst stateHooks =\n\t\t\t\t\thookState._component.__hooks._list.filter(isStateHook);\n\n\t\t\t\tconst allHooksEmpty = stateHooks.every(x => !x._nextValue);\n\t\t\t\t// When we have no updated hooks in the component we invoke the previous SCU or\n\t\t\t\t// traverse the VDOM tree further.\n\t\t\t\tif (allHooksEmpty) {\n\t\t\t\t\treturn prevScu ? prevScu.call(this, p, s, c) : true;\n\t\t\t\t}\n\n\t\t\t\t// We check whether we have components with a nextValue set that\n\t\t\t\t// have values that aren't equal to one another this pushes\n\t\t\t\t// us to update further down the tree\n\t\t\t\tlet shouldUpdate = false;\n\t\t\t\tstateHooks.forEach(hookItem => {\n\t\t\t\t\tif (hookItem._nextValue) {\n\t\t\t\t\t\tconst currentValue = hookItem._value[0];\n\t\t\t\t\t\thookItem._value = hookItem._nextValue;\n\t\t\t\t\t\thookItem._nextValue = undefined;\n\t\t\t\t\t\tif (currentValue !== hookItem._value[0]) shouldUpdate = true;\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\treturn shouldUpdate || hookState._component.props !== p\n\t\t\t\t\t? prevScu\n\t\t\t\t\t\t? prevScu.call(this, p, s, c)\n\t\t\t\t\t\t: true\n\t\t\t\t\t: false;\n\t\t\t}\n\n\t\t\tcurrentComponent.shouldComponentUpdate = updateHookState;\n\t\t}\n\t}\n\n\treturn hookState._nextValue || hookState._value;\n}\n\n/**\n * @param {import('./internal').Effect} callback\n * @param {unknown[]} args\n * @returns {void}\n */\nexport function useEffect(callback, args) {\n\t/** @type {import('./internal').EffectHookState} */\n\tconst state = getHookState(currentIndex++, 3);\n\tif (!options._skipEffects && argsChanged(state._args, args)) {\n\t\tstate._value = callback;\n\t\tstate._pendingArgs = args;\n\n\t\tcurrentComponent.__hooks._pendingEffects.push(state);\n\t}\n}\n\n/**\n * @param {import('./internal').Effect} callback\n * @param {unknown[]} args\n * @returns {void}\n */\nexport function useLayoutEffect(callback, args) {\n\t/** @type {import('./internal').EffectHookState} */\n\tconst state = getHookState(currentIndex++, 4);\n\tif (!options._skipEffects && argsChanged(state._args, args)) {\n\t\tstate._value = callback;\n\t\tstate._pendingArgs = args;\n\n\t\tcurrentComponent._renderCallbacks.push(state);\n\t}\n}\n\n/** @type {(initialValue: unknown) => unknown} */\nexport function useRef(initialValue) {\n\tcurrentHook = 5;\n\treturn useMemo(() => ({ current: initialValue }), []);\n}\n\n/**\n * @param {object} ref\n * @param {() => object} createHandle\n * @param {unknown[]} args\n * @returns {void}\n */\nexport function useImperativeHandle(ref, createHandle, args) {\n\tcurrentHook = 6;\n\tuseLayoutEffect(\n\t\t() => {\n\t\t\tif (typeof ref == 'function') {\n\t\t\t\tref(createHandle());\n\t\t\t\treturn () => ref(null);\n\t\t\t} else if (ref) {\n\t\t\t\tref.current = createHandle();\n\t\t\t\treturn () => (ref.current = null);\n\t\t\t}\n\t\t},\n\t\targs == null ? args : args.concat(ref)\n\t);\n}\n\n/**\n * @template {unknown} T\n * @param {() => T} factory\n * @param {unknown[]} args\n * @returns {T}\n */\nexport function useMemo(factory, args) {\n\t/** @type {import('./internal').MemoHookState<T>} */\n\tconst state = getHookState(currentIndex++, 7);\n\tif (argsChanged(state._args, args)) {\n\t\tstate._value = factory();\n\t\tstate._args = args;\n\t\tstate._factory = factory;\n\t}\n\n\treturn state._value;\n}\n\n/**\n * @param {() => void} callback\n * @param {unknown[]} args\n * @returns {() => void}\n */\nexport function useCallback(callback, args) {\n\tcurrentHook = 8;\n\treturn useMemo(() => callback, args);\n}\n\n/**\n * @param {import('./internal').PreactContext} context\n */\nexport function useContext(context) {\n\tconst provider = currentComponent.context[context._id];\n\t// We could skip this call here, but than we'd not call\n\t// `options._hook`. We need to do that in order to make\n\t// the devtools aware of this hook.\n\t/** @type {import('./internal').ContextHookState} */\n\tconst state = getHookState(currentIndex++, 9);\n\t// The devtools needs access to the context object to\n\t// be able to pull of the default value when no provider\n\t// is present in the tree.\n\tstate._context = context;\n\tif (!provider) return context._defaultValue;\n\t// This is probably not safe to convert to \"!\"\n\tif (state._value == null) {\n\t\tstate._value = true;\n\t\tprovider.sub(currentComponent);\n\t}\n\treturn provider.props.value;\n}\n\n/**\n * Display a custom label for a custom hook for the devtools panel\n * @type {<T>(value: T, cb?: (value: T) => string | number) => void}\n */\nexport function useDebugValue(value, formatter) {\n\tif (options.useDebugValue) {\n\t\toptions.useDebugValue(\n\t\t\tformatter ? formatter(value) : /** @type {any}*/ (value)\n\t\t);\n\t}\n}\n\n/**\n * @param {(error: unknown, errorInfo: import('preact').ErrorInfo) => void} cb\n * @returns {[unknown, () => void]}\n */\nexport function useErrorBoundary(cb) {\n\t/** @type {import('./internal').ErrorBoundaryHookState} */\n\tconst state = getHookState(currentIndex++, 10);\n\tconst errState = useState();\n\tstate._value = cb;\n\tif (!currentComponent.componentDidCatch) {\n\t\tcurrentComponent.componentDidCatch = (err, errorInfo) => {\n\t\t\tif (state._value) state._value(err, errorInfo);\n\t\t\terrState[1](err);\n\t\t};\n\t}\n\treturn [\n\t\terrState[0],\n\t\t() => {\n\t\t\terrState[1](undefined);\n\t\t}\n\t];\n}\n\n/** @type {() => string} */\nexport function useId() {\n\t/** @type {import('./internal').IdHookState} */\n\tconst state = getHookState(currentIndex++, 11);\n\tif (!state._value) {\n\t\t// Grab either the root node or the nearest async boundary node.\n\t\t/** @type {import('./internal.d').VNode} */\n\t\tlet root = currentComponent._vnode;\n\t\twhile (root !== null && !root._mask && root._parent !== null) {\n\t\t\troot = root._parent;\n\t\t}\n\n\t\tlet mask = root._mask || (root._mask = [0, 0]);\n\t\tstate._value = 'P' + mask[0] + '-' + mask[1]++;\n\t}\n\n\treturn state._value;\n}\n\n/**\n * After paint effects consumer.\n */\nfunction flushAfterPaintEffects() {\n\tlet component;\n\twhile ((component = afterPaintEffects.shift())) {\n\t\tif (!component._parentDom || !component.__hooks) continue;\n\t\ttry {\n\t\t\tcomponent.__hooks._pendingEffects.forEach(invokeCleanup);\n\t\t\tcomponent.__hooks._pendingEffects.forEach(invokeEffect);\n\t\t\tcomponent.__hooks._pendingEffects = [];\n\t\t} catch (e) {\n\t\t\tcomponent.__hooks._pendingEffects = [];\n\t\t\toptions._catchError(e, component._vnode);\n\t\t}\n\t}\n}\n\nlet HAS_RAF = typeof requestAnimationFrame == 'function';\n\n/**\n * Schedule a callback to be invoked after the browser has a chance to paint a new frame.\n * Do this by combining requestAnimationFrame (rAF) + setTimeout to invoke a callback after\n * the next browser frame.\n *\n * Also, schedule a timeout in parallel to the the rAF to ensure the callback is invoked\n * even if RAF doesn't fire (for example if the browser tab is not visible)\n *\n * @param {() => void} callback\n */\nfunction afterNextFrame(callback) {\n\tconst done = () => {\n\t\tclearTimeout(timeout);\n\t\tif (HAS_RAF) cancelAnimationFrame(raf);\n\t\tsetTimeout(callback);\n\t};\n\tconst timeout = setTimeout(done, RAF_TIMEOUT);\n\n\tlet raf;\n\tif (HAS_RAF) {\n\t\traf = requestAnimationFrame(done);\n\t}\n}\n\n// Note: if someone used options.debounceRendering = requestAnimationFrame,\n// then effects will ALWAYS run on the NEXT frame instead of the current one, incurring a ~16ms delay.\n// Perhaps this is not such a big deal.\n/**\n * Schedule afterPaintEffects flush after the browser paints\n * @param {number} newQueueLength\n * @returns {void}\n */\nfunction afterPaint(newQueueLength) {\n\tif (newQueueLength === 1 || prevRaf !== options.requestAnimationFrame) {\n\t\tprevRaf = options.requestAnimationFrame;\n\t\t(prevRaf || afterNextFrame)(flushAfterPaintEffects);\n\t}\n}\n\n/**\n * @param {import('./internal').HookState} hook\n * @returns {void}\n */\nfunction invokeCleanup(hook) {\n\t// A hook cleanup can introduce a call to render which creates a new root, this will call options.vnode\n\t// and move the currentComponent away.\n\tconst comp = currentComponent;\n\tlet cleanup = hook._cleanup;\n\tif (typeof cleanup == 'function') {\n\t\thook._cleanup = undefined;\n\t\tcleanup();\n\t}\n\n\tcurrentComponent = comp;\n}\n\n/**\n * Invoke a Hook's effect\n * @param {import('./internal').EffectHookState} hook\n * @returns {void}\n */\nfunction invokeEffect(hook) {\n\t// A hook call can introduce a call to render which creates a new root, this will call options.vnode\n\t// and move the currentComponent away.\n\tconst comp = currentComponent;\n\thook._cleanup = hook._value();\n\tcurrentComponent = comp;\n}\n\n/**\n * @param {unknown[]} oldArgs\n * @param {unknown[]} newArgs\n * @returns {boolean}\n */\nfunction argsChanged(oldArgs, newArgs) {\n\treturn (\n\t\t!oldArgs ||\n\t\toldArgs.length !== newArgs.length ||\n\t\tnewArgs.some((arg, index) => arg !== oldArgs[index])\n\t);\n}\n\n/**\n * @template Arg\n * @param {Arg} arg\n * @param {(arg: Arg) => any} f\n * @returns {any}\n */\nfunction invokeOrReturn(arg, f) {\n\treturn typeof f == 'function' ? f(arg) : f;\n}\n"],"names":["currentIndex","currentComponent","previousComponent","currentHook","afterPaintEffects","options","_options","oldBeforeDiff","__b","oldBeforeRender","__r","oldAfterDiff","diffed","oldCommit","__c","oldBeforeUnmount","unmount","oldRoot","__","RAF_TIMEOUT","prevRaf","vnode","parentDom","__k","__m","hooks","__H","__h","forEach","hookItem","__N","_pendingArgs","undefined","invokeCleanup","invokeEffect","c","length","afterPaint","push","commitQueue","some","component","filter","cb","e","__e","__v","hasErrored","s","getHookState","index","type","useState","initialState","useReducer","invokeOrReturn","reducer","init","hookState","_reducer","action","currentValue","nextValue","setState","_hasScuFromHooks","updateHookState","p","isStateHook","x","stateHooks","allHooksEmpty","every","prevScu","call","shouldUpdate","props","shouldComponentUpdate","prevCWU","componentWillUpdate","tmp","useEffect","callback","args","state","__s","argsChanged","useLayoutEffect","useRef","initialValue","useMemo","current","useImperativeHandle","ref","createHandle","concat","factory","useCallback","useContext","context","provider","sub","value","useDebugValue","formatter","useErrorBoundary","errState","componentDidCatch","err","errorInfo","useId","root","mask","flushAfterPaintEffects","shift","__P","HAS_RAF","requestAnimationFrame","afterNextFrame","done","clearTimeout","timeout","cancelAnimationFrame","raf","setTimeout","newQueueLength","hook","comp","cleanup","oldArgs","newArgs","arg","f"],"mappings":";;;;;CAEA;CACA,IAAIA,YAAY,CAAA;;CAEhB;CACA,IAAIC,gBAAgB,CAAA;;CAEpB;CACA,IAAIC,iBAAiB,CAAA;;CAErB;CACA,IAAIC,WAAW,GAAG,CAAC,CAAA;;CAEnB;CACA,IAAIC,iBAAiB,GAAG,EAAE,CAAA;;CAE1B;CACA,IAAMC,OAAO,8CAAgDC,cAAS,CAAA;CAEtE,IAAIC,aAAa,GAAGF,OAAO,CAAAG,GAAM,CAAA;CACjC,IAAIC,eAAe,GAAGJ,OAAO,CAAAK,GAAQ,CAAA;CACrC,IAAIC,YAAY,GAAGN,OAAO,CAACO,MAAM,CAAA;CACjC,IAAIC,SAAS,GAAGR,OAAO,CAAAS,GAAQ,CAAA;CAC/B,IAAIC,gBAAgB,GAAGV,OAAO,CAACW,OAAO,CAAA;CACtC,IAAIC,OAAO,GAAGZ,OAAO,CAAAa,EAAM,CAAA;CAE3B,IAAMC,WAAW,GAAG,GAAG,CAAA;CACvB,IAAIC,OAAO,CAAA;;CAEX;CACAf,OAAO,CAAAG,GAAA,GAAS,UAAAa,KAAK,EAAI;CACxBpB,EAAAA,gBAAgB,GAAG,IAAI,CAAA;CACvB,EAAA,IAAIM,aAAa,EAAEA,aAAa,CAACc,KAAK,CAAC,CAAA;CACxC,CAAC,CAAA;CAEDhB,OAAO,CAAAa,EAAA,GAAS,UAACG,KAAK,EAAEC,SAAS,EAAK;GACrC,IAAID,KAAK,IAAIC,SAAS,CAAAC,GAAU,IAAID,SAAS,CAAAC,GAAA,CAAAC,GAAgB,EAAE;CAC9DH,IAAAA,KAAK,CAAAG,GAAA,GAASF,SAAS,CAAAC,GAAA,CAAAC,GAAgB,CAAA;CACxC,GAAA;CAEA,EAAA,IAAIP,OAAO,EAAEA,OAAO,CAACI,KAAK,EAAEC,SAAS,CAAC,CAAA;CACvC,CAAC,CAAA;;CAED;CACAjB,OAAO,CAAAK,GAAA,GAAW,UAAAW,KAAK,EAAI;CAC1B,EAAA,IAAIZ,eAAe,EAAEA,eAAe,CAACY,KAAK,CAAC,CAAA;GAE3CpB,gBAAgB,GAAGoB,KAAK,CAAAP,GAAW,CAAA;CACnCd,EAAAA,YAAY,GAAG,CAAC,CAAA;CAEhB,EAAA,IAAMyB,KAAK,GAAGxB,gBAAgB,CAAAyB,GAAQ,CAAA;CACtC,EAAA,IAAID,KAAK,EAAE;KACV,IAAIvB,iBAAiB,KAAKD,gBAAgB,EAAE;OAC3CwB,KAAK,CAAAE,GAAA,GAAmB,EAAE,CAAA;OAC1B1B,gBAAgB,CAAA0B,GAAA,GAAoB,EAAE,CAAA;CACtCF,MAAAA,KAAK,CAAAP,EAAA,CAAOU,OAAO,CAAC,UAAAC,QAAQ,EAAI;SAC/B,IAAIA,QAAQ,CAAAC,GAAA,EAAa;CACxBD,UAAAA,QAAQ,CAAAX,EAAA,GAAUW,QAAQ,CAAAC,GAAW,CAAA;CACtC,SAAA;CACAD,QAAAA,QAAQ,CAACE,YAAY,GAAGF,QAAQ,CAAAC,GAAA,GAAcE,SAAS,CAAA;CACxD,OAAC,CAAC,CAAA;CACH,KAAC,MAAM;CACNP,MAAAA,KAAK,CAAAE,GAAA,CAAiBC,OAAO,CAACK,aAAa,CAAC,CAAA;CAC5CR,MAAAA,KAAK,CAAAE,GAAA,CAAiBC,OAAO,CAACM,YAAY,CAAC,CAAA;OAC3CT,KAAK,CAAAE,GAAA,GAAmB,EAAE,CAAA;CAC1B3B,MAAAA,YAAY,GAAG,CAAC,CAAA;CACjB,KAAA;CACD,GAAA;CACAE,EAAAA,iBAAiB,GAAGD,gBAAgB,CAAA;CACrC,CAAC,CAAA;;CAED;CACAI,OAAO,CAACO,MAAM,GAAG,UAAAS,KAAK,EAAI;CACzB,EAAA,IAAIV,YAAY,EAAEA,YAAY,CAACU,KAAK,CAAC,CAAA;CAErC,EAAA,IAAMc,CAAC,GAAGd,KAAK,CAAAP,GAAW,CAAA;CAC1B,EAAA,IAAIqB,CAAC,IAAIA,CAAC,CAAAT,GAAQ,EAAE;CACnB,IAAA,IAAIS,CAAC,CAAAT,GAAA,CAAAC,GAAA,CAAyBS,MAAM,EAAEC,UAAU,CAACjC,iBAAiB,CAACkC,IAAI,CAACH,CAAC,CAAC,CAAC,CAAA;KAC3EA,CAAC,CAAAT,GAAA,CAAAR,EAAA,CAAeU,OAAO,CAAC,UAAAC,QAAQ,EAAI;OACnC,IAAIA,QAAQ,CAACE,YAAY,EAAE;CAC1BF,QAAAA,QAAQ,CAAAH,GAAA,GAASG,QAAQ,CAACE,YAAY,CAAA;CACvC,OAAA;OACAF,QAAQ,CAACE,YAAY,GAAGC,SAAS,CAAA;CAClC,KAAC,CAAC,CAAA;CACH,GAAA;GACA9B,iBAAiB,GAAGD,gBAAgB,GAAG,IAAI,CAAA;CAC5C,CAAC,CAAA;;CAED;CACA;CACAI,OAAO,CAAAS,GAAA,GAAW,UAACO,KAAK,EAAEkB,WAAW,EAAK;CACzCA,EAAAA,WAAW,CAACC,IAAI,CAAC,UAAAC,SAAS,EAAI;KAC7B,IAAI;CACHA,MAAAA,SAAS,CAAAd,GAAA,CAAkBC,OAAO,CAACK,aAAa,CAAC,CAAA;OACjDQ,SAAS,CAAAd,GAAA,GAAoBc,SAAS,CAAAd,GAAA,CAAkBe,MAAM,CAAC,UAAAC,EAAE,EAAA;SAAA,OAChEA,EAAE,CAAAzB,EAAA,GAAUgB,YAAY,CAACS,EAAE,CAAC,GAAG,IAAI,CAAA;CAAA,OACpC,CAAC,CAAA;MACD,CAAC,OAAOC,CAAC,EAAE;CACXL,MAAAA,WAAW,CAACC,IAAI,CAAC,UAAAL,CAAC,EAAI;SACrB,IAAIA,CAAC,CAAAR,GAAA,EAAmBQ,CAAC,CAAAR,GAAA,GAAoB,EAAE,CAAA;CAChD,OAAC,CAAC,CAAA;CACFY,MAAAA,WAAW,GAAG,EAAE,CAAA;OAChBlC,OAAO,CAAAwC,GAAA,CAAaD,CAAC,EAAEH,SAAS,CAAAK,GAAO,CAAC,CAAA;CACzC,KAAA;CACD,GAAC,CAAC,CAAA;CAEF,EAAA,IAAIjC,SAAS,EAAEA,SAAS,CAACQ,KAAK,EAAEkB,WAAW,CAAC,CAAA;CAC7C,CAAC,CAAA;;CAED;CACAlC,OAAO,CAACW,OAAO,GAAG,UAAAK,KAAK,EAAI;CAC1B,EAAA,IAAIN,gBAAgB,EAAEA,gBAAgB,CAACM,KAAK,CAAC,CAAA;CAE7C,EAAA,IAAMc,CAAC,GAAGd,KAAK,CAAAP,GAAW,CAAA;CAC1B,EAAA,IAAIqB,CAAC,IAAIA,CAAC,CAAAT,GAAQ,EAAE;CACnB,IAAA,IAAIqB,UAAU,CAAA;KACdZ,CAAC,CAAAT,GAAA,CAAAR,EAAA,CAAeU,OAAO,CAAC,UAAAoB,CAAC,EAAI;OAC5B,IAAI;SACHf,aAAa,CAACe,CAAC,CAAC,CAAA;QAChB,CAAC,OAAOJ,CAAC,EAAE;CACXG,QAAAA,UAAU,GAAGH,CAAC,CAAA;CACf,OAAA;CACD,KAAC,CAAC,CAAA;KACFT,CAAC,CAAAT,GAAA,GAAWM,SAAS,CAAA;KACrB,IAAIe,UAAU,EAAE1C,OAAO,CAAAwC,GAAA,CAAaE,UAAU,EAAEZ,CAAC,CAAAW,GAAO,CAAC,CAAA;CAC1D,GAAA;CACD,CAAC,CAAA;;CAED;CACA;CACA;CACA;CACA;CACA;CACA,SAASG,YAAYA,CAACC,KAAK,EAAEC,IAAI,EAAE;GAClC,IAAI9C,OAAO,CAAAsB,GAAA,EAAQ;KAClBtB,OAAO,CAAAsB,GAAA,CAAO1B,gBAAgB,EAAEiD,KAAK,EAAE/C,WAAW,IAAIgD,IAAI,CAAC,CAAA;CAC5D,GAAA;CACAhD,EAAAA,WAAW,GAAG,CAAC,CAAA;;CAEf;CACA;CACA;CACA;CACA;GACA,IAAMsB,KAAK,GACVxB,gBAAgB,CAAAyB,GAAA,KACfzB,gBAAgB,CAAAyB,GAAA,GAAW;CAC3BR,IAAAA,EAAA,EAAO,EAAE;CACTS,IAAAA,GAAA,EAAiB,EAAA;CAClB,GAAC,CAAC,CAAA;CAEH,EAAA,IAAIuB,KAAK,IAAIzB,KAAK,CAAAP,EAAA,CAAOkB,MAAM,EAAE;CAChCX,IAAAA,KAAK,CAAAP,EAAA,CAAOoB,IAAI,CAAC,EAAE,CAAC,CAAA;CACrB,GAAA;CAEA,EAAA,OAAOb,KAAK,CAAAP,EAAA,CAAOgC,KAAK,CAAC,CAAA;CAC1B,CAAA;;CAEA;CACA;CACA;CACA;CACA;CACO,SAASE,QAAQA,CAACC,YAAY,EAAE;CACtClD,EAAAA,WAAW,GAAG,CAAC,CAAA;CACf,EAAA,OAAOmD,UAAU,CAACC,cAAc,EAAEF,YAAY,CAAC,CAAA;CAChD,CAAA;;CAEA;CACA;CACA;CACA;CACA;CACA;CACA;CACA;CACO,SAASC,UAAUA,CAACE,OAAO,EAAEH,YAAY,EAAEI,IAAI,EAAE;CACvD;GACA,IAAMC,SAAS,GAAGT,YAAY,CAACjD,YAAY,EAAE,EAAE,CAAC,CAAC,CAAA;GACjD0D,SAAS,CAACC,QAAQ,GAAGH,OAAO,CAAA;CAC5B,EAAA,IAAI,CAACE,SAAS,CAAA5C,GAAW,EAAE;KAC1B4C,SAAS,CAAAxC,EAAA,GAAU,CAClB,CAACuC,IAAI,GAAGF,cAAc,CAACvB,SAAS,EAAEqB,YAAY,CAAC,GAAGI,IAAI,CAACJ,YAAY,CAAC,EAEpE,UAAAO,MAAM,EAAI;CACT,MAAA,IAAMC,YAAY,GAAGH,SAAS,CAAA5B,GAAA,GAC3B4B,SAAS,CAAA5B,GAAA,CAAY,CAAC,CAAC,GACvB4B,SAAS,CAAAxC,EAAA,CAAQ,CAAC,CAAC,CAAA;OACtB,IAAM4C,SAAS,GAAGJ,SAAS,CAACC,QAAQ,CAACE,YAAY,EAAED,MAAM,CAAC,CAAA;OAE1D,IAAIC,YAAY,KAAKC,SAAS,EAAE;CAC/BJ,QAAAA,SAAS,CAAA5B,GAAA,GAAc,CAACgC,SAAS,EAAEJ,SAAS,CAAAxC,EAAA,CAAQ,CAAC,CAAC,CAAC,CAAA;CACvDwC,QAAAA,SAAS,CAAA5C,GAAA,CAAYiD,QAAQ,CAAC,EAAE,CAAC,CAAA;CAClC,OAAA;CACD,KAAC,CACD,CAAA;KAEDL,SAAS,CAAA5C,GAAA,GAAcb,gBAAgB,CAAA;CAEvC,IAAA,IAAI,CAACA,gBAAgB,CAAC+D,gBAAgB,EAAE;CAoBvC;CACA;CACA;CACA;CACA;CACA;CACA;CACH;CACA;CACA;CACG;CACA;OAAA,IACSC,eAAe,GAAxB,SAASA,eAAeA,CAACC,CAAC,EAAElB,CAAC,EAAEb,CAAC,EAAE;SACjC,IAAI,CAACuB,SAAS,CAAA5C,GAAA,CAAAY,GAAmB,EAAE,OAAO,IAAI,CAAA;;CAE9C;CACA,QAAA,IAAMyC,WAAW,GAAG,SAAdA,WAAWA,CAAGC,CAAC,EAAA;CAAA,UAAA,OAAI,CAAC,CAACA,CAAC,CAAAtD,GAAW,CAAA;CAAA,SAAA,CAAA;CACvC,QAAA,IAAMuD,UAAU,GACfX,SAAS,CAAA5C,GAAA,CAAAY,GAAA,CAAAR,EAAA,CAA0BwB,MAAM,CAACyB,WAAW,CAAC,CAAA;CAEvD,QAAA,IAAMG,aAAa,GAAGD,UAAU,CAACE,KAAK,CAAC,UAAAH,CAAC,EAAA;WAAA,OAAI,CAACA,CAAC,CAAAtC,GAAW,CAAA;UAAC,CAAA,CAAA;CAC1D;CACA;CACA,QAAA,IAAIwC,aAAa,EAAE;CAClB,UAAA,OAAOE,OAAO,GAAGA,OAAO,CAACC,IAAI,CAAC,IAAI,EAAEP,CAAC,EAAElB,CAAC,EAAEb,CAAC,CAAC,GAAG,IAAI,CAAA;CACpD,SAAA;;CAEA;CACA;CACA;SACA,IAAIuC,YAAY,GAAG,KAAK,CAAA;CACxBL,QAAAA,UAAU,CAACzC,OAAO,CAAC,UAAAC,QAAQ,EAAI;WAC9B,IAAIA,QAAQ,CAAAC,GAAA,EAAa;CACxB,YAAA,IAAM+B,YAAY,GAAGhC,QAAQ,CAAAX,EAAA,CAAQ,CAAC,CAAC,CAAA;CACvCW,YAAAA,QAAQ,CAAAX,EAAA,GAAUW,QAAQ,CAAAC,GAAW,CAAA;aACrCD,QAAQ,CAAAC,GAAA,GAAcE,SAAS,CAAA;aAC/B,IAAI6B,YAAY,KAAKhC,QAAQ,CAAAX,EAAA,CAAQ,CAAC,CAAC,EAAEwD,YAAY,GAAG,IAAI,CAAA;CAC7D,WAAA;CACD,SAAC,CAAC,CAAA;SAEF,OAAOA,YAAY,IAAIhB,SAAS,CAAA5C,GAAA,CAAY6D,KAAK,KAAKT,CAAC,GACpDM,OAAO,GACNA,OAAO,CAACC,IAAI,CAAC,IAAI,EAAEP,CAAC,EAAElB,CAAC,EAAEb,CAAC,CAAC,GAC3B,IAAI,GACL,KAAK,CAAA;QACR,CAAA;OAhEDlC,gBAAgB,CAAC+D,gBAAgB,GAAG,IAAI,CAAA;CACxC,MAAA,IAAIQ,OAAO,GAAGvE,gBAAgB,CAAC2E,qBAAqB,CAAA;CACpD,MAAA,IAAMC,OAAO,GAAG5E,gBAAgB,CAAC6E,mBAAmB,CAAA;;CAEpD;CACA;CACA;OACA7E,gBAAgB,CAAC6E,mBAAmB,GAAG,UAAUZ,CAAC,EAAElB,CAAC,EAAEb,CAAC,EAAE;SACzD,IAAI,IAAI,CAAAU,GAAA,EAAS;WAChB,IAAIkC,GAAG,GAAGP,OAAO,CAAA;CACjB;CACAA,UAAAA,OAAO,GAAGxC,SAAS,CAAA;CACnBiC,UAAAA,eAAe,CAACC,CAAC,EAAElB,CAAC,EAAEb,CAAC,CAAC,CAAA;CACxBqC,UAAAA,OAAO,GAAGO,GAAG,CAAA;CACd,SAAA;CAEA,QAAA,IAAIF,OAAO,EAAEA,OAAO,CAACJ,IAAI,CAAC,IAAI,EAAEP,CAAC,EAAElB,CAAC,EAAEb,CAAC,CAAC,CAAA;QACxC,CAAA;OAiDDlC,gBAAgB,CAAC2E,qBAAqB,GAAGX,eAAe,CAAA;CACzD,KAAA;CACD,GAAA;CAEA,EAAA,OAAOP,SAAS,CAAA5B,GAAA,IAAe4B,SAAS,CAAAxC,EAAO,CAAA;CAChD,CAAA;;CAEA;CACA;CACA;CACA;CACA;CACO,SAAS8D,SAASA,CAACC,QAAQ,EAAEC,IAAI,EAAE;CACzC;GACA,IAAMC,KAAK,GAAGlC,YAAY,CAACjD,YAAY,EAAE,EAAE,CAAC,CAAC,CAAA;CAC7C,EAAA,IAAI,CAACK,OAAO,CAAA+E,GAAa,IAAIC,WAAW,CAACF,KAAK,CAAAzD,GAAA,EAAQwD,IAAI,CAAC,EAAE;KAC5DC,KAAK,CAAAjE,EAAA,GAAU+D,QAAQ,CAAA;KACvBE,KAAK,CAACpD,YAAY,GAAGmD,IAAI,CAAA;KAEzBjF,gBAAgB,CAAAyB,GAAA,CAAAC,GAAA,CAAyBW,IAAI,CAAC6C,KAAK,CAAC,CAAA;CACrD,GAAA;CACD,CAAA;;CAEA;CACA;CACA;CACA;CACA;CACO,SAASG,eAAeA,CAACL,QAAQ,EAAEC,IAAI,EAAE;CAC/C;GACA,IAAMC,KAAK,GAAGlC,YAAY,CAACjD,YAAY,EAAE,EAAE,CAAC,CAAC,CAAA;CAC7C,EAAA,IAAI,CAACK,OAAO,CAAA+E,GAAa,IAAIC,WAAW,CAACF,KAAK,CAAAzD,GAAA,EAAQwD,IAAI,CAAC,EAAE;KAC5DC,KAAK,CAAAjE,EAAA,GAAU+D,QAAQ,CAAA;KACvBE,KAAK,CAACpD,YAAY,GAAGmD,IAAI,CAAA;CAEzBjF,IAAAA,gBAAgB,CAAA0B,GAAA,CAAkBW,IAAI,CAAC6C,KAAK,CAAC,CAAA;CAC9C,GAAA;CACD,CAAA;;CAEA;CACO,SAASI,MAAMA,CAACC,YAAY,EAAE;CACpCrF,EAAAA,WAAW,GAAG,CAAC,CAAA;CACf,EAAA,OAAOsF,OAAO,CAAC,YAAA;KAAA,OAAO;CAAEC,MAAAA,OAAO,EAAEF,YAAAA;MAAc,CAAA;IAAC,EAAE,EAAE,CAAC,CAAA;CACtD,CAAA;;CAEA;CACA;CACA;CACA;CACA;CACA;CACO,SAASG,mBAAmBA,CAACC,GAAG,EAAEC,YAAY,EAAEX,IAAI,EAAE;CAC5D/E,EAAAA,WAAW,GAAG,CAAC,CAAA;CACfmF,EAAAA,eAAe,CACd,YAAM;CACL,IAAA,IAAI,OAAOM,GAAG,IAAI,UAAU,EAAE;CAC7BA,MAAAA,GAAG,CAACC,YAAY,EAAE,CAAC,CAAA;OACnB,OAAO,YAAA;SAAA,OAAMD,GAAG,CAAC,IAAI,CAAC,CAAA;CAAA,OAAA,CAAA;MACtB,MAAM,IAAIA,GAAG,EAAE;CACfA,MAAAA,GAAG,CAACF,OAAO,GAAGG,YAAY,EAAE,CAAA;OAC5B,OAAO,YAAA;CAAA,QAAA,OAAOD,GAAG,CAACF,OAAO,GAAG,IAAI,CAAA;QAAC,CAAA;CAClC,KAAA;CACD,GAAC,EACDR,IAAI,IAAI,IAAI,GAAGA,IAAI,GAAGA,IAAI,CAACY,MAAM,CAACF,GAAG,CACtC,CAAC,CAAA;CACF,CAAA;;CAEA;CACA;CACA;CACA;CACA;CACA;CACO,SAASH,OAAOA,CAACM,OAAO,EAAEb,IAAI,EAAE;CACtC;GACA,IAAMC,KAAK,GAAGlC,YAAY,CAACjD,YAAY,EAAE,EAAE,CAAC,CAAC,CAAA;GAC7C,IAAIqF,WAAW,CAACF,KAAK,CAAAzD,GAAA,EAAQwD,IAAI,CAAC,EAAE;CACnCC,IAAAA,KAAK,CAAAjE,EAAA,GAAU6E,OAAO,EAAE,CAAA;KACxBZ,KAAK,CAAAzD,GAAA,GAASwD,IAAI,CAAA;KAClBC,KAAK,CAAAxD,GAAA,GAAYoE,OAAO,CAAA;CACzB,GAAA;GAEA,OAAOZ,KAAK,CAAAjE,EAAA,CAAA;CACb,CAAA;;CAEA;CACA;CACA;CACA;CACA;CACO,SAAS8E,WAAWA,CAACf,QAAQ,EAAEC,IAAI,EAAE;CAC3C/E,EAAAA,WAAW,GAAG,CAAC,CAAA;CACf,EAAA,OAAOsF,OAAO,CAAC,YAAA;CAAA,IAAA,OAAMR,QAAQ,CAAA;CAAA,GAAA,EAAEC,IAAI,CAAC,CAAA;CACrC,CAAA;;CAEA;CACA;CACA;CACO,SAASe,UAAUA,CAACC,OAAO,EAAE;GACnC,IAAMC,QAAQ,GAAGlG,gBAAgB,CAACiG,OAAO,CAACA,OAAO,CAAApF,GAAA,CAAK,CAAA;CACtD;CACA;CACA;CACA;GACA,IAAMqE,KAAK,GAAGlC,YAAY,CAACjD,YAAY,EAAE,EAAE,CAAC,CAAC,CAAA;CAC7C;CACA;CACA;GACAmF,KAAK,CAAAhD,CAAA,GAAY+D,OAAO,CAAA;CACxB,EAAA,IAAI,CAACC,QAAQ,EAAE,OAAOD,OAAO,CAAAhF,EAAA,CAAA;CAC7B;CACA,EAAA,IAAIiE,KAAK,CAAAjE,EAAA,IAAW,IAAI,EAAE;KACzBiE,KAAK,CAAAjE,EAAA,GAAU,IAAI,CAAA;CACnBiF,IAAAA,QAAQ,CAACC,GAAG,CAACnG,gBAAgB,CAAC,CAAA;CAC/B,GAAA;CACA,EAAA,OAAOkG,QAAQ,CAACxB,KAAK,CAAC0B,KAAK,CAAA;CAC5B,CAAA;;CAEA;CACA;CACA;CACA;CACO,SAASC,aAAaA,CAACD,KAAK,EAAEE,SAAS,EAAE;GAC/C,IAAIlG,OAAO,CAACiG,aAAa,EAAE;CAC1BjG,IAAAA,OAAO,CAACiG,aAAa,CACpBC,SAAS,GAAGA,SAAS,CAACF,KAAK,CAAC,sBAAsBA,KAAK,CACxD,CAAC,CAAA;CACF,GAAA;CACD,CAAA;;CAEA;CACA;CACA;CACA;CACO,SAASG,gBAAgBA,CAAC7D,EAAE,EAAE;CACpC;GACA,IAAMwC,KAAK,GAAGlC,YAAY,CAACjD,YAAY,EAAE,EAAE,EAAE,CAAC,CAAA;CAC9C,EAAA,IAAMyG,QAAQ,GAAGrD,QAAQ,EAAE,CAAA;GAC3B+B,KAAK,CAAAjE,EAAA,GAAUyB,EAAE,CAAA;CACjB,EAAA,IAAI,CAAC1C,gBAAgB,CAACyG,iBAAiB,EAAE;CACxCzG,IAAAA,gBAAgB,CAACyG,iBAAiB,GAAG,UAACC,GAAG,EAAEC,SAAS,EAAK;OACxD,IAAIzB,KAAK,CAAAjE,EAAA,EAASiE,KAAK,CAAAjE,EAAA,CAAQyF,GAAG,EAAEC,SAAS,CAAC,CAAA;CAC9CH,MAAAA,QAAQ,CAAC,CAAC,CAAC,CAACE,GAAG,CAAC,CAAA;MAChB,CAAA;CACF,GAAA;CACA,EAAA,OAAO,CACNF,QAAQ,CAAC,CAAC,CAAC,EACX,YAAM;CACLA,IAAAA,QAAQ,CAAC,CAAC,CAAC,CAACzE,SAAS,CAAC,CAAA;CACvB,GAAC,CACD,CAAA;CACF,CAAA;;CAEA;CACO,SAAS6E,KAAKA,GAAG;CACvB;GACA,IAAM1B,KAAK,GAAGlC,YAAY,CAACjD,YAAY,EAAE,EAAE,EAAE,CAAC,CAAA;CAC9C,EAAA,IAAI,CAACmF,KAAK,CAAAjE,EAAO,EAAE;CAClB;CACA;CACA,IAAA,IAAI4F,IAAI,GAAG7G,gBAAgB,CAAA6C,GAAO,CAAA;CAClC,IAAA,OAAOgE,IAAI,KAAK,IAAI,IAAI,CAACA,IAAI,CAAAtF,GAAM,IAAIsF,IAAI,CAAA5F,EAAA,KAAa,IAAI,EAAE;OAC7D4F,IAAI,GAAGA,IAAI,CAAA5F,EAAQ,CAAA;CACpB,KAAA;CAEA,IAAA,IAAI6F,IAAI,GAAGD,IAAI,CAAAtF,GAAA,KAAWsF,IAAI,CAAAtF,GAAA,GAAS,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAA;CAC9C2D,IAAAA,KAAK,CAAAjE,EAAA,GAAU,GAAG,GAAG6F,IAAI,CAAC,CAAC,CAAC,GAAG,GAAG,GAAGA,IAAI,CAAC,CAAC,CAAC,EAAE,CAAA;CAC/C,GAAA;GAEA,OAAO5B,KAAK,CAAAjE,EAAA,CAAA;CACb,CAAA;;CAEA;CACA;CACA;CACA,SAAS8F,sBAAsBA,GAAG;CACjC,EAAA,IAAIvE,SAAS,CAAA;CACb,EAAA,OAAQA,SAAS,GAAGrC,iBAAiB,CAAC6G,KAAK,EAAE,EAAG;KAC/C,IAAI,CAACxE,SAAS,CAAAyE,GAAW,IAAI,CAACzE,SAAS,CAAAf,GAAQ,EAAE,SAAA;KACjD,IAAI;OACHe,SAAS,CAAAf,GAAA,CAAAC,GAAA,CAAyBC,OAAO,CAACK,aAAa,CAAC,CAAA;OACxDQ,SAAS,CAAAf,GAAA,CAAAC,GAAA,CAAyBC,OAAO,CAACM,YAAY,CAAC,CAAA;CACvDO,MAAAA,SAAS,CAAAf,GAAA,CAAAC,GAAA,GAA2B,EAAE,CAAA;MACtC,CAAC,OAAOiB,CAAC,EAAE;CACXH,MAAAA,SAAS,CAAAf,GAAA,CAAAC,GAAA,GAA2B,EAAE,CAAA;OACtCtB,OAAO,CAAAwC,GAAA,CAAaD,CAAC,EAAEH,SAAS,CAAAK,GAAO,CAAC,CAAA;CACzC,KAAA;CACD,GAAA;CACD,CAAA;CAEA,IAAIqE,OAAO,GAAG,OAAOC,qBAAqB,IAAI,UAAU,CAAA;;CAExD;CACA;CACA;CACA;CACA;CACA;CACA;CACA;CACA;CACA;CACA,SAASC,cAAcA,CAACpC,QAAQ,EAAE;CACjC,EAAA,IAAMqC,IAAI,GAAG,SAAPA,IAAIA,GAAS;KAClBC,YAAY,CAACC,OAAO,CAAC,CAAA;CACrB,IAAA,IAAIL,OAAO,EAAEM,oBAAoB,CAACC,GAAG,CAAC,CAAA;KACtCC,UAAU,CAAC1C,QAAQ,CAAC,CAAA;IACpB,CAAA;CACD,EAAA,IAAMuC,OAAO,GAAGG,UAAU,CAACL,IAAI,EAAEnG,WAAW,CAAC,CAAA;CAE7C,EAAA,IAAIuG,GAAG,CAAA;CACP,EAAA,IAAIP,OAAO,EAAE;CACZO,IAAAA,GAAG,GAAGN,qBAAqB,CAACE,IAAI,CAAC,CAAA;CAClC,GAAA;CACD,CAAA;;CAEA;CACA;CACA;CACA;CACA;CACA;CACA;CACA;CACA,SAASjF,UAAUA,CAACuF,cAAc,EAAE;GACnC,IAAIA,cAAc,KAAK,CAAC,IAAIxG,OAAO,KAAKf,OAAO,CAAC+G,qBAAqB,EAAE;KACtEhG,OAAO,GAAGf,OAAO,CAAC+G,qBAAqB,CAAA;CACvC,IAAA,CAAChG,OAAO,IAAIiG,cAAc,EAAEL,sBAAsB,CAAC,CAAA;CACpD,GAAA;CACD,CAAA;;CAEA;CACA;CACA;CACA;CACA,SAAS/E,aAAaA,CAAC4F,IAAI,EAAE;CAC5B;CACA;GACA,IAAMC,IAAI,GAAG7H,gBAAgB,CAAA;CAC7B,EAAA,IAAI8H,OAAO,GAAGF,IAAI,CAAA/G,GAAS,CAAA;CAC3B,EAAA,IAAI,OAAOiH,OAAO,IAAI,UAAU,EAAE;KACjCF,IAAI,CAAA/G,GAAA,GAAYkB,SAAS,CAAA;CACzB+F,IAAAA,OAAO,EAAE,CAAA;CACV,GAAA;CAEA9H,EAAAA,gBAAgB,GAAG6H,IAAI,CAAA;CACxB,CAAA;;CAEA;CACA;CACA;CACA;CACA;CACA,SAAS5F,YAAYA,CAAC2F,IAAI,EAAE;CAC3B;CACA;GACA,IAAMC,IAAI,GAAG7H,gBAAgB,CAAA;CAC7B4H,EAAAA,IAAI,CAAA/G,GAAA,GAAY+G,IAAI,CAAA3G,EAAA,EAAS,CAAA;CAC7BjB,EAAAA,gBAAgB,GAAG6H,IAAI,CAAA;CACxB,CAAA;;CAEA;CACA;CACA;CACA;CACA;CACA,SAASzC,WAAWA,CAAC2C,OAAO,EAAEC,OAAO,EAAE;CACtC,EAAA,OACC,CAACD,OAAO,IACRA,OAAO,CAAC5F,MAAM,KAAK6F,OAAO,CAAC7F,MAAM,IACjC6F,OAAO,CAACzF,IAAI,CAAC,UAAC0F,GAAG,EAAEhF,KAAK,EAAA;CAAA,IAAA,OAAKgF,GAAG,KAAKF,OAAO,CAAC9E,KAAK,CAAC,CAAA;IAAC,CAAA,CAAA;CAEtD,CAAA;;CAEA;CACA;CACA;CACA;CACA;CACA;CACA,SAASK,cAAcA,CAAC2E,GAAG,EAAEC,CAAC,EAAE;GAC/B,OAAO,OAAOA,CAAC,IAAI,UAAU,GAAGA,CAAC,CAACD,GAAG,CAAC,GAAGC,CAAC,CAAA;CAC3C;;;;;;;;;;;;;;;;;;;"}