{"version":3,"file":"hooks.js","sources":["../src/index.js"],"sourcesContent":["import { options as _options } from 'preact';\n\n/** @type {number} */\nlet currentIndex;\n\n/** @type {import('./internal').Component} */\nlet currentComponent;\n\n/** @type {import('./internal').Component} */\nlet previousComponent;\n\n/** @type {number} */\nlet currentHook = 0;\n\n/** @type {Array<import('./internal').Component>} */\nlet afterPaintEffects = [];\n\n// Cast to use internal Options type\nconst options = /** @type {import('./internal').Options} */ (_options);\n\nlet oldBeforeDiff = options._diff;\nlet oldBeforeRender = options._render;\nlet oldAfterDiff = options.diffed;\nlet oldCommit = options._commit;\nlet oldBeforeUnmount = options.unmount;\nlet oldRoot = options._root;\n\nconst RAF_TIMEOUT = 100;\nlet prevRaf;\n\n/** @type {(vnode: import('./internal').VNode) => void} */\noptions._diff = vnode => {\n\tcurrentComponent = null;\n\tif (oldBeforeDiff) oldBeforeDiff(vnode);\n};\n\noptions._root = (vnode, parentDom) => {\n\tif (vnode && parentDom._children && parentDom._children._mask) {\n\t\tvnode._mask = parentDom._children._mask;\n\t}\n\n\tif (oldRoot) oldRoot(vnode, parentDom);\n};\n\n/** @type {(vnode: import('./internal').VNode) => void} */\noptions._render = vnode => {\n\tif (oldBeforeRender) oldBeforeRender(vnode);\n\n\tcurrentComponent = vnode._component;\n\tcurrentIndex = 0;\n\n\tconst hooks = currentComponent.__hooks;\n\tif (hooks) {\n\t\tif (previousComponent === currentComponent) {\n\t\t\thooks._pendingEffects = [];\n\t\t\tcurrentComponent._renderCallbacks = [];\n\t\t\thooks._list.forEach(hookItem => {\n\t\t\t\tif (hookItem._nextValue) {\n\t\t\t\t\thookItem._value = hookItem._nextValue;\n\t\t\t\t}\n\t\t\t\thookItem._pendingArgs = hookItem._nextValue = undefined;\n\t\t\t});\n\t\t} else {\n\t\t\thooks._pendingEffects.forEach(invokeCleanup);\n\t\t\thooks._pendingEffects.forEach(invokeEffect);\n\t\t\thooks._pendingEffects = [];\n\t\t\tcurrentIndex = 0;\n\t\t}\n\t}\n\tpreviousComponent = currentComponent;\n};\n\n/** @type {(vnode: import('./internal').VNode) => void} */\noptions.diffed = vnode => {\n\tif (oldAfterDiff) oldAfterDiff(vnode);\n\n\tconst c = vnode._component;\n\tif (c && c.__hooks) {\n\t\tif (c.__hooks._pendingEffects.length) afterPaint(afterPaintEffects.push(c));\n\t\tc.__hooks._list.forEach(hookItem => {\n\t\t\tif (hookItem._pendingArgs) {\n\t\t\t\thookItem._args = hookItem._pendingArgs;\n\t\t\t}\n\t\t\thookItem._pendingArgs = undefined;\n\t\t});\n\t}\n\tpreviousComponent = currentComponent = null;\n};\n\n// TODO: Improve typing of commitQueue parameter\n/** @type {(vnode: import('./internal').VNode, commitQueue: any) => void} */\noptions._commit = (vnode, commitQueue) => {\n\tcommitQueue.some(component => {\n\t\ttry {\n\t\t\tcomponent._renderCallbacks.forEach(invokeCleanup);\n\t\t\tcomponent._renderCallbacks = component._renderCallbacks.filter(cb =>\n\t\t\t\tcb._value ? invokeEffect(cb) : true\n\t\t\t);\n\t\t} catch (e) {\n\t\t\tcommitQueue.some(c => {\n\t\t\t\tif (c._renderCallbacks) c._renderCallbacks = [];\n\t\t\t});\n\t\t\tcommitQueue = [];\n\t\t\toptions._catchError(e, component._vnode);\n\t\t}\n\t});\n\n\tif (oldCommit) oldCommit(vnode, commitQueue);\n};\n\n/** @type {(vnode: import('./internal').VNode) => void} */\noptions.unmount = vnode => {\n\tif (oldBeforeUnmount) oldBeforeUnmount(vnode);\n\n\tconst c = vnode._component;\n\tif (c && c.__hooks) {\n\t\tlet hasErrored;\n\t\tc.__hooks._list.forEach(s => {\n\t\t\ttry {\n\t\t\t\tinvokeCleanup(s);\n\t\t\t} catch (e) {\n\t\t\t\thasErrored = e;\n\t\t\t}\n\t\t});\n\t\tc.__hooks = undefined;\n\t\tif (hasErrored) options._catchError(hasErrored, c._vnode);\n\t}\n};\n\n/**\n * Get a hook's state from the currentComponent\n * @param {number} index The index of the hook to get\n * @param {number} type The index of the hook to get\n * @returns {any}\n */\nfunction getHookState(index, type) {\n\tif (options._hook) {\n\t\toptions._hook(currentComponent, index, currentHook || type);\n\t}\n\tcurrentHook = 0;\n\n\t// Largely inspired by:\n\t// * https://github.com/michael-klein/funcy.js/blob/f6be73468e6ec46b0ff5aa3cc4c9baf72a29025a/src/hooks/core_hooks.mjs\n\t// * https://github.com/michael-klein/funcy.js/blob/650beaa58c43c33a74820a3c98b3c7079cf2e333/src/renderer.mjs\n\t// Other implementations to look at:\n\t// * https://codesandbox.io/s/mnox05qp8\n\tconst hooks =\n\t\tcurrentComponent.__hooks ||\n\t\t(currentComponent.__hooks = {\n\t\t\t_list: [],\n\t\t\t_pendingEffects: []\n\t\t});\n\n\tif (index >= hooks._list.length) {\n\t\thooks._list.push({});\n\t}\n\n\treturn hooks._list[index];\n}\n\n/**\n * @template {unknown} S\n * @param {import('./index').Dispatch<import('./index').StateUpdater<S>>} [initialState]\n * @returns {[S, (state: S) => void]}\n */\nexport function useState(initialState) {\n\tcurrentHook = 1;\n\treturn useReducer(invokeOrReturn, initialState);\n}\n\n/**\n * @template {unknown} S\n * @template {unknown} A\n * @param {import('./index').Reducer<S, A>} reducer\n * @param {import('./index').Dispatch<import('./index').StateUpdater<S>>} initialState\n * @param {(initialState: any) => void} [init]\n * @returns {[ S, (state: S) => void ]}\n */\nexport function useReducer(reducer, initialState, init) {\n\t/** @type {import('./internal').ReducerHookState} */\n\tconst hookState = getHookState(currentIndex++, 2);\n\thookState._reducer = reducer;\n\tif (!hookState._component) {\n\t\thookState._value = [\n\t\t\t!init ? invokeOrReturn(undefined, initialState) : init(initialState),\n\n\t\t\taction => {\n\t\t\t\tconst currentValue = hookState._nextValue\n\t\t\t\t\t? hookState._nextValue[0]\n\t\t\t\t\t: hookState._value[0];\n\t\t\t\tconst nextValue = hookState._reducer(currentValue, action);\n\n\t\t\t\tif (currentValue !== nextValue) {\n\t\t\t\t\thookState._nextValue = [nextValue, hookState._value[1]];\n\t\t\t\t\thookState._component.setState({});\n\t\t\t\t}\n\t\t\t}\n\t\t];\n\n\t\thookState._component = currentComponent;\n\n\t\tif (!currentComponent._hasScuFromHooks) {\n\t\t\tcurrentComponent._hasScuFromHooks = true;\n\t\t\tlet prevScu = currentComponent.shouldComponentUpdate;\n\t\t\tconst prevCWU = currentComponent.componentWillUpdate;\n\n\t\t\t// If we're dealing with a forced update `shouldComponentUpdate` will\n\t\t\t// not be called. But we use that to update the hook values, so we\n\t\t\t// need to call it.\n\t\t\tcurrentComponent.componentWillUpdate = function (p, s, c) {\n\t\t\t\tif (this._force) {\n\t\t\t\t\tlet tmp = prevScu;\n\t\t\t\t\t// Clear to avoid other sCU hooks from being called\n\t\t\t\t\tprevScu = undefined;\n\t\t\t\t\tupdateHookState(p, s, c);\n\t\t\t\t\tprevScu = tmp;\n\t\t\t\t}\n\n\t\t\t\tif (prevCWU) prevCWU.call(this, p, s, c);\n\t\t\t};\n\n\t\t\t// This SCU has the purpose of bailing out after repeated updates\n\t\t\t// to stateful hooks.\n\t\t\t// we store the next value in _nextValue[0] and keep doing that for all\n\t\t\t// state setters, if we have next states and\n\t\t\t// all next states within a component end up being equal to their original state\n\t\t\t// we are safe to bail out for this specific component.\n\t\t\t/**\n\t\t\t *\n\t\t\t * @type {import('./internal').Component[\"shouldComponentUpdate\"]}\n\t\t\t */\n\t\t\t// @ts-ignore - We don't use TS to downtranspile\n\t\t\t// eslint-disable-next-line no-inner-declarations\n\t\t\tfunction updateHookState(p, s, c) {\n\t\t\t\tif (!hookState._component.__hooks) return true;\n\n\t\t\t\t/** @type {(x: import('./internal').HookState) => x is import('./internal').ReducerHookState} */\n\t\t\t\tconst isStateHook = x => !!x._component;\n\t\t\t\tconst stateHooks =\n\t\t\t\t\thookState._component.__hooks._list.filter(isStateHook);\n\n\t\t\t\tconst allHooksEmpty = stateHooks.every(x => !x._nextValue);\n\t\t\t\t// When we have no updated hooks in the component we invoke the previous SCU or\n\t\t\t\t// traverse the VDOM tree further.\n\t\t\t\tif (allHooksEmpty) {\n\t\t\t\t\treturn prevScu ? prevScu.call(this, p, s, c) : true;\n\t\t\t\t}\n\n\t\t\t\t// We check whether we have components with a nextValue set that\n\t\t\t\t// have values that aren't equal to one another this pushes\n\t\t\t\t// us to update further down the tree\n\t\t\t\tlet shouldUpdate = false;\n\t\t\t\tstateHooks.forEach(hookItem => {\n\t\t\t\t\tif (hookItem._nextValue) {\n\t\t\t\t\t\tconst currentValue = hookItem._value[0];\n\t\t\t\t\t\thookItem._value = hookItem._nextValue;\n\t\t\t\t\t\thookItem._nextValue = undefined;\n\t\t\t\t\t\tif (currentValue !== hookItem._value[0]) shouldUpdate = true;\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\treturn shouldUpdate || hookState._component.props !== p\n\t\t\t\t\t? prevScu\n\t\t\t\t\t\t? prevScu.call(this, p, s, c)\n\t\t\t\t\t\t: true\n\t\t\t\t\t: false;\n\t\t\t}\n\n\t\t\tcurrentComponent.shouldComponentUpdate = updateHookState;\n\t\t}\n\t}\n\n\treturn hookState._nextValue || hookState._value;\n}\n\n/**\n * @param {import('./internal').Effect} callback\n * @param {unknown[]} args\n * @returns {void}\n */\nexport function useEffect(callback, args) {\n\t/** @type {import('./internal').EffectHookState} */\n\tconst state = getHookState(currentIndex++, 3);\n\tif (!options._skipEffects && argsChanged(state._args, args)) {\n\t\tstate._value = callback;\n\t\tstate._pendingArgs = args;\n\n\t\tcurrentComponent.__hooks._pendingEffects.push(state);\n\t}\n}\n\n/**\n * @param {import('./internal').Effect} callback\n * @param {unknown[]} args\n * @returns {void}\n */\nexport function useLayoutEffect(callback, args) {\n\t/** @type {import('./internal').EffectHookState} */\n\tconst state = getHookState(currentIndex++, 4);\n\tif (!options._skipEffects && argsChanged(state._args, args)) {\n\t\tstate._value = callback;\n\t\tstate._pendingArgs = args;\n\n\t\tcurrentComponent._renderCallbacks.push(state);\n\t}\n}\n\n/** @type {(initialValue: unknown) => unknown} */\nexport function useRef(initialValue) {\n\tcurrentHook = 5;\n\treturn useMemo(() => ({ current: initialValue }), []);\n}\n\n/**\n * @param {object} ref\n * @param {() => object} createHandle\n * @param {unknown[]} args\n * @returns {void}\n */\nexport function useImperativeHandle(ref, createHandle, args) {\n\tcurrentHook = 6;\n\tuseLayoutEffect(\n\t\t() => {\n\t\t\tif (typeof ref == 'function') {\n\t\t\t\tref(createHandle());\n\t\t\t\treturn () => ref(null);\n\t\t\t} else if (ref) {\n\t\t\t\tref.current = createHandle();\n\t\t\t\treturn () => (ref.current = null);\n\t\t\t}\n\t\t},\n\t\targs == null ? args : args.concat(ref)\n\t);\n}\n\n/**\n * @template {unknown} T\n * @param {() => T} factory\n * @param {unknown[]} args\n * @returns {T}\n */\nexport function useMemo(factory, args) {\n\t/** @type {import('./internal').MemoHookState<T>} */\n\tconst state = getHookState(currentIndex++, 7);\n\tif (argsChanged(state._args, args)) {\n\t\tstate._value = factory();\n\t\tstate._args = args;\n\t\tstate._factory = factory;\n\t}\n\n\treturn state._value;\n}\n\n/**\n * @param {() => void} callback\n * @param {unknown[]} args\n * @returns {() => void}\n */\nexport function useCallback(callback, args) {\n\tcurrentHook = 8;\n\treturn useMemo(() => callback, args);\n}\n\n/**\n * @param {import('./internal').PreactContext} context\n */\nexport function useContext(context) {\n\tconst provider = currentComponent.context[context._id];\n\t// We could skip this call here, but than we'd not call\n\t// `options._hook`. We need to do that in order to make\n\t// the devtools aware of this hook.\n\t/** @type {import('./internal').ContextHookState} */\n\tconst state = getHookState(currentIndex++, 9);\n\t// The devtools needs access to the context object to\n\t// be able to pull of the default value when no provider\n\t// is present in the tree.\n\tstate._context = context;\n\tif (!provider) return context._defaultValue;\n\t// This is probably not safe to convert to \"!\"\n\tif (state._value == null) {\n\t\tstate._value = true;\n\t\tprovider.sub(currentComponent);\n\t}\n\treturn provider.props.value;\n}\n\n/**\n * Display a custom label for a custom hook for the devtools panel\n * @type {<T>(value: T, cb?: (value: T) => string | number) => void}\n */\nexport function useDebugValue(value, formatter) {\n\tif (options.useDebugValue) {\n\t\toptions.useDebugValue(\n\t\t\tformatter ? formatter(value) : /** @type {any}*/ (value)\n\t\t);\n\t}\n}\n\n/**\n * @param {(error: unknown, errorInfo: import('preact').ErrorInfo) => void} cb\n * @returns {[unknown, () => void]}\n */\nexport function useErrorBoundary(cb) {\n\t/** @type {import('./internal').ErrorBoundaryHookState} */\n\tconst state = getHookState(currentIndex++, 10);\n\tconst errState = useState();\n\tstate._value = cb;\n\tif (!currentComponent.componentDidCatch) {\n\t\tcurrentComponent.componentDidCatch = (err, errorInfo) => {\n\t\t\tif (state._value) state._value(err, errorInfo);\n\t\t\terrState[1](err);\n\t\t};\n\t}\n\treturn [\n\t\terrState[0],\n\t\t() => {\n\t\t\terrState[1](undefined);\n\t\t}\n\t];\n}\n\n/** @type {() => string} */\nexport function useId() {\n\t/** @type {import('./internal').IdHookState} */\n\tconst state = getHookState(currentIndex++, 11);\n\tif (!state._value) {\n\t\t// Grab either the root node or the nearest async boundary node.\n\t\t/** @type {import('./internal.d').VNode} */\n\t\tlet root = currentComponent._vnode;\n\t\twhile (root !== null && !root._mask && root._parent !== null) {\n\t\t\troot = root._parent;\n\t\t}\n\n\t\tlet mask = root._mask || (root._mask = [0, 0]);\n\t\tstate._value = 'P' + mask[0] + '-' + mask[1]++;\n\t}\n\n\treturn state._value;\n}\n\n/**\n * After paint effects consumer.\n */\nfunction flushAfterPaintEffects() {\n\tlet component;\n\twhile ((component = afterPaintEffects.shift())) {\n\t\tif (!component._parentDom || !component.__hooks) continue;\n\t\ttry {\n\t\t\tcomponent.__hooks._pendingEffects.forEach(invokeCleanup);\n\t\t\tcomponent.__hooks._pendingEffects.forEach(invokeEffect);\n\t\t\tcomponent.__hooks._pendingEffects = [];\n\t\t} catch (e) {\n\t\t\tcomponent.__hooks._pendingEffects = [];\n\t\t\toptions._catchError(e, component._vnode);\n\t\t}\n\t}\n}\n\nlet HAS_RAF = typeof requestAnimationFrame == 'function';\n\n/**\n * Schedule a callback to be invoked after the browser has a chance to paint a new frame.\n * Do this by combining requestAnimationFrame (rAF) + setTimeout to invoke a callback after\n * the next browser frame.\n *\n * Also, schedule a timeout in parallel to the the rAF to ensure the callback is invoked\n * even if RAF doesn't fire (for example if the browser tab is not visible)\n *\n * @param {() => void} callback\n */\nfunction afterNextFrame(callback) {\n\tconst done = () => {\n\t\tclearTimeout(timeout);\n\t\tif (HAS_RAF) cancelAnimationFrame(raf);\n\t\tsetTimeout(callback);\n\t};\n\tconst timeout = setTimeout(done, RAF_TIMEOUT);\n\n\tlet raf;\n\tif (HAS_RAF) {\n\t\traf = requestAnimationFrame(done);\n\t}\n}\n\n// Note: if someone used options.debounceRendering = requestAnimationFrame,\n// then effects will ALWAYS run on the NEXT frame instead of the current one, incurring a ~16ms delay.\n// Perhaps this is not such a big deal.\n/**\n * Schedule afterPaintEffects flush after the browser paints\n * @param {number} newQueueLength\n * @returns {void}\n */\nfunction afterPaint(newQueueLength) {\n\tif (newQueueLength === 1 || prevRaf !== options.requestAnimationFrame) {\n\t\tprevRaf = options.requestAnimationFrame;\n\t\t(prevRaf || afterNextFrame)(flushAfterPaintEffects);\n\t}\n}\n\n/**\n * @param {import('./internal').HookState} hook\n * @returns {void}\n */\nfunction invokeCleanup(hook) {\n\t// A hook cleanup can introduce a call to render which creates a new root, this will call options.vnode\n\t// and move the currentComponent away.\n\tconst comp = currentComponent;\n\tlet cleanup = hook._cleanup;\n\tif (typeof cleanup == 'function') {\n\t\thook._cleanup = undefined;\n\t\tcleanup();\n\t}\n\n\tcurrentComponent = comp;\n}\n\n/**\n * Invoke a Hook's effect\n * @param {import('./internal').EffectHookState} hook\n * @returns {void}\n */\nfunction invokeEffect(hook) {\n\t// A hook call can introduce a call to render which creates a new root, this will call options.vnode\n\t// and move the currentComponent away.\n\tconst comp = currentComponent;\n\thook._cleanup = hook._value();\n\tcurrentComponent = comp;\n}\n\n/**\n * @param {unknown[]} oldArgs\n * @param {unknown[]} newArgs\n * @returns {boolean}\n */\nfunction argsChanged(oldArgs, newArgs) {\n\treturn (\n\t\t!oldArgs ||\n\t\toldArgs.length !== newArgs.length ||\n\t\tnewArgs.some((arg, index) => arg !== oldArgs[index])\n\t);\n}\n\n/**\n * @template Arg\n * @param {Arg} arg\n * @param {(arg: Arg) => any} f\n * @returns {any}\n */\nfunction invokeOrReturn(arg, f) {\n\treturn typeof f == 'function' ? f(arg) : f;\n}\n"],"names":["currentIndex","currentComponent","previousComponent","currentHook","afterPaintEffects","options","_options","oldBeforeDiff","__b","oldBeforeRender","__r","oldAfterDiff","diffed","oldCommit","__c","oldBeforeUnmount","unmount","oldRoot","__","RAF_TIMEOUT","prevRaf","vnode","parentDom","__k","__m","hooks","__H","__h","forEach","hookItem","__N","_pendingArgs","undefined","invokeCleanup","invokeEffect","c","length","afterPaint","push","commitQueue","some","component","filter","cb","e","__e","__v","hasErrored","s","getHookState","index","type","useState","initialState","useReducer","invokeOrReturn","reducer","init","hookState","_reducer","action","currentValue","nextValue","setState","_hasScuFromHooks","updateHookState","p","isStateHook","x","stateHooks","allHooksEmpty","every","prevScu","call","shouldUpdate","props","shouldComponentUpdate","prevCWU","componentWillUpdate","tmp","useEffect","callback","args","state","__s","argsChanged","useLayoutEffect","useRef","initialValue","useMemo","current","useImperativeHandle","ref","createHandle","concat","factory","useCallback","useContext","context","provider","sub","value","useDebugValue","formatter","useErrorBoundary","errState","componentDidCatch","err","errorInfo","useId","root","mask","flushAfterPaintEffects","shift","__P","HAS_RAF","requestAnimationFrame","afterNextFrame","done","clearTimeout","timeout","cancelAnimationFrame","raf","setTimeout","newQueueLength","hook","comp","cleanup","oldArgs","newArgs","arg","f"],"mappings":"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"}